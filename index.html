<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <title>ATC</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.3/normalize.min.css" type="text/css" media="screen" title="normalize" charset="utf-8">
        <script src="http://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.5.0/fabric.min.js" type="text/javascript" charset="utf-8"></script>
        <style>
            body, html {
                width: 100%;
                height: 100%;
            }

            #scope {
                width: 100%;
                height: 100%;
                display: block;
                background: #194850;
            }

            .airplane {
                display: block;
                position: absolute;
                height: 5px;
                width: 5px;
                border: 1px solid black;
            }
        </style>

    </head>
    <body>
        <canvas id="scope"></canvas>
    <script type="text/javascript">
        var scope = new fabric.Canvas('scope');
        scope.setHeight(window.innerHeight);
        scope.setWidth(window.innerWidth);
        scope.renderAll()

        fabric.Object.prototype.setOriginToCenter = function () {
            this._originalOriginX = this.originX;
            this._originalOriginY = this.originY;

            var center = this.getCenterPoint();

            this.set({
                originX: 'center',
                originY: 'center',
                left: center.x,
                top: center.y
            });
        };

        fabric.Object.prototype.setCenterToOrigin = function () {
            var originPoint = this.translateToOriginPoint(
            this.getCenterPoint(),
            this._originalOriginX,
            this._originalOriginY);

            this.set({
                originX: this._originalOriginX,
                originY: this._originalOriginY,
                left: originPoint.x,
                top: originPoint.y
            });
        };

        function rotateObject(obj, angleOffset) {
            var resetOrigin = false;

            if (!obj) return;

            var angle = obj.getAngle() + angleOffset;

            if ((obj.originX !== 'center' || obj.originY !== 'center') && obj.centeredRotation) {
                obj.setOriginToCenter && obj.setOriginToCenter();
                resetOrigin = true;
            }

            angle = angle > 360 ? 90 : angle < 0 ? 270 : angle;

            obj.setAngle(angle).setCoords();

            if (resetOrigin) {
                obj.setCenterToOrigin && obj.setCenterToOrigin();
            }

            scope.renderAll();
        }


    function createAircraft(startLoc, heading) {
        var BLIP_SIZE = 6,
            BLIP_OFFSET = BLIP_SIZE * 2,
            BLIP_CENTER = BLIP_SIZE / 2

        var x = startLoc[0],
            y = startLoc[1]

        var cos = Math.cos(heading),
            sin = Math.sin(heading)

        var blip = new fabric.Rect({
            top: y,
            left: x,
            width: BLIP_SIZE,
            height: BLIP_SIZE,
            strokeWidth: 1,
            stroke: 'white'
        });

        var tail = new fabric.Line(
        [
            x - BLIP_OFFSET,  // start x
            y + BLIP_CENTER,  // start y
            x + BLIP_OFFSET + BLIP_SIZE,  // end x
            y + BLIP_CENTER], // end y
        {
            strokeWidth: 1,
            stroke: 'white'
        });


        aircraft = new fabric.Group([blip, tail]);
        rotateObject(aircraft, 270);
        return aircraft

    }

    airplane = createAircraft([20, 20]);
    scope.add(airplane);
    function move() {
        airplane.animate('left', '+=10');
        scope.renderAll();
    }

    setInterval(move, 1000);

    </script>
    </body>
</html>
